function formToJSON(e){var o={};return $(e).find(":input[name]:enabled").each(function(){var e=$(this),a=e.attr("name");o[a]=o[a]?o[a]+","+e.val():e.val()}),o}function likePost(e,o){var a=$("input[name='auth_token']").val(),s=$("input[name='handle']").val(),t="request=like_post&auth_token="+a+"&handle="+s+"&post_token="+e;$.ajax({type:"POST",url:"http://gobeebot.com/",data:t,dataType:"html",success:function(e){var a=$(o).parents(".feed_item").attr("id");$("#"+a+" .loved img").attr("src","img/heart_loved.svg");var s=parseInt($("#"+a+" .loved span").html()),t=s+1;$("#"+a+" .loved span").html(t)}})}function locateMe(){var e={timeout:3e4};watchID=navigator.geolocation.getCurrentPosition(onGeoSuccess,onGeoError,e)}function onGeoSuccess(e){$("input[name='lat']").val(e.coords.latitude),$("input[name='long']").val(e.coords.longitude);var o=formToJSON("#find_posts");$.ajax({type:"POST",url:"http://gobeebot.com/",data:o,dataType:"json",success:function(e){if(e.success){$("#public_info .success.notice").show(),console.log("sent"),console.log(JSON.stringify(e));var o=e.response;$("#posts_near_me").html(" "),$.each(o,function(e,o){var a=o.author_handle,s=o.data_location,t=o.author_avatar,n=o.post_token,i=o.times_seen,l=o.times_liked,r=o.special;$("#posts_near_me").append("<div class='row feed_item' id='"+r+"'><div class='twelve columns'><div class='author_info'><img src='"+t+"' /><strong>"+a+"</strong><div class='clearfix'></div></div><div><img src='"+s+"' class='data_img' onClick='likePost(\""+n+"\", this)' /></div><div class='buttons'><div class='eye'><img src='img/eye_seen.svg' alt='' /><span>"+i+"</span><div class='clearfix'></div></div><!--seen--><div class='loved'><img src='img/heart_unloved.svg' alt='' /><span>"+l+"</span><div class='clearfix'></div></div><!--loved--><div class='more'></div><!--more--></div><!--buttons--></div></div>")})}else $("#public_info .failure.notice").show(),console.log("error"),e.errors&&console.log(e.errors)}})}function onGeoError(e){alert("code: "+e.code+"\nmessage: "+e.message+"\n")}var watchID=null;$(document).ready(function(){locateMe()});